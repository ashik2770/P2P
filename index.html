<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Video Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .futuristic-bg {
            background: linear-gradient(135deg, #0f0f23 0%, #1e1e4b 100%);
            overflow: hidden;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(147, 51, 234, 0.2);
        }
        .glow-effect {
            box-shadow: 0 0 15px rgba(147, 51, 234, 0.4);
            transition: all 0.3s ease;
        }
        .video-overlay {
            background: linear-gradient(to bottom, rgba(0,0,0,0) 70%, rgba(0,0,0,0.7));
        }
        .floating-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
    </style>
</head>
<body class="futuristic-bg min-h-screen flex items-center justify-center p-6">
    <div class="floating-particles" id="particles"></div>
    <div class="container mx-auto max-w-5xl relative z-10">
        <div class="glass-effect rounded-3xl p-8">
            <h1 class="text-4xl font-extrabold text-white mb-8 text-center bg-gradient-to-r from-purple-400 via-pink-500 to-blue-500 bg-clip-text text-transparent animate-pulse">
                Quantum Video Portal
            </h1>

            <!-- Connection Panel -->
            <div class="flex flex-col md:flex-row gap-4 mb-8">
                <input 
                    id="userId" 
                    type="text" 
                    placeholder="Your Quantum ID" 
                    class="flex-1 p-4 rounded-xl bg-gray-900/30 text-white border border-gray-800 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-all duration-300"
                >
                <input 
                    id="remoteId" 
                    type="text" 
                    placeholder="Target Quantum ID" 
                    class="flex-1 p-4 rounded-xl bg-gray-900/30 text-white border border-gray-800 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-all duration-300"
                >
                <button 
                    id="connectBtn" 
                    class="px-8 py-4 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-xl transition-all duration-300 transform hover:scale-105"
                >
                    Initiate Quantum Link
                </button>
            </div>

            <!-- Video Display -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="relative rounded-xl overflow-hidden glow-effect group">
                    <video id="localVideo" autoplay muted class="w-full aspect-video object-cover"></video>
                    <div class="absolute inset-0 video-overlay"></div>
                    <span class="absolute bottom-3 left-3 text-white bg-purple-900/50 px-3 py-1 rounded-lg">Local Feed</span>
                </div>
                <div class="relative rounded-xl overflow-hidden glow-effect group">
                    <video id="remoteVideo" autoplay class="w-full aspect-video object-cover"></video>
                    <div class="absolute inset-0 video-overlay"></div>
                    <span class="absolute bottom-3 left-3 text-white bg-purple-900/50 px-3 py-1 rounded-lg">Remote Feed</span>
                </div>
            </div>

            <!-- Control Panel -->
            <div class="flex justify-center gap-6">
                <button id="toggleVideo" class="p-4 bg-gray-900/50 hover:bg-purple-600 text-white rounded-full transition-all duration-300 transform hover:scale-110" title="Toggle Video">ðŸ“¹</button>
                <button id="toggleAudio" class="p-4 bg-gray-900/50 hover:bg-purple-600 text-white rounded-full transition-all duration-300 transform hover:scale-110" title="Toggle Audio">ðŸŽ¤</button>
                <button id="endCall" class="p-4 bg-red-900/50 hover:bg-red-600 text-white rounded-full transition-all duration-300 transform hover:scale-110" title="End Call">âœ•</button>
            </div>

            <!-- Status Display -->
            <p id="status" class="text-center text-gray-300 mt-6 font-mono"></p>
        </div>
    </div>

    <script>
        // WebRTC Setup
        const config = { iceServers: [{ urls: ['stun:stun.l.google.com:19302', 'stun:stun1.l.google.com:19302'] }] };
        const elements = {
            localVideo: document.getElementById('localVideo'),
            remoteVideo: document.getElementById('remoteVideo'),
            userId: document.getElementById('userId'),
            remoteId: document.getElementById('remoteId'),
            connectBtn: document.getElementById('connectBtn'),
            toggleVideoBtn: document.getElementById('toggleVideo'),
            toggleAudioBtn: document.getElementById('toggleAudio'),
            endCallBtn: document.getElementById('endCall'),
            status: document.getElementById('status')
        };

        let stream, pc, ws;

        // Initialize
        elements.userId.value ||= Math.random().toString(36).slice(2, 10);
        ws = new WebSocket('wss://your-signaling-server.com');
        ws.onmessage = e => handleSignal(JSON.parse(e.data));

        // Core Functions
        async function initMedia() {
            stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
            elements.localVideo.srcObject = stream;
            elements.status.textContent = 'Quantum stream initialized';
        }

        function setupPeer() {
            pc = new RTCPeerConnection(config);
            stream.getTracks().forEach(track => pc.addTrack(track, stream));
            pc.ontrack = e => elements.remoteVideo.srcObject = e.streams[0];
            pc.onicecandidate = e => e.candidate && ws.send(JSON.stringify({ candidate: e.candidate }));
            pc.onconnectionstatechange = () => elements.status.textContent = `Link: ${pc.connectionState}`;
        }

        async function makeCall() {
            if (!elements.remoteId.value) return elements.status.textContent = 'Target ID required';
            await initMedia();
            setupPeer();
            const offer = await pc.createOffer();
            await pc.setLocalDescription(offer);
            ws.send(JSON.stringify({ offer, from: elements.userId.value, to: elements.remoteId.value }));
            elements.status.textContent = 'Establishing quantum link...';
        }

        async function handleSignal(data) {
            if (data.offer) {
                await initMedia();
                setupPeer();
                await pc.setRemoteDescription(new RTCSessionDescription(data.offer));
                const answer = await pc.createAnswer();
                await pc.setLocalDescription(answer);
                ws.send(JSON.stringify({ answer, from: elements.userId.value, to: elements.remoteId.value }));
            } else if (data.answer) {
                await pc.setRemoteDescription(new RTCSessionDescription(data.answer));
            } else if (data.candidate) {
                await pc.addIceCandidate(new RTCIceCandidate(data.candidate));
            }
        }

        function toggleTrack(type) {
            const track = stream.getTracks().find(t => t.kind === type);
            track.enabled = !track.enabled;
            return track.enabled;
        }

        function endCall() {
            if (pc) {
                pc.close();
                stream.getTracks().forEach(t => t.stop());
                elements.localVideo.srcObject = elements.remoteVideo.srcObject = null;
                elements.status.textContent = 'Quantum link terminated';
            }
        }

        // Event Listeners
        elements.connectBtn.onclick = makeCall;
        elements.toggleVideoBtn.onclick = () => elements.toggleVideoBtn.classList.toggle('bg-purple-600', toggleTrack('video'));
        elements.toggleAudioBtn.onclick = () => elements.toggleAudioBtn.classList.toggle('bg-purple-600', toggleTrack('audio'));
        elements.endCallBtn.onclick = endCall;

        // Particle Animation
        function createParticles() {
            const canvas = document.createElement('canvas');
            document.getElementById('particles').appendChild(canvas);
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = Array.from({ length: 50 }, () => ({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 3 + 1,
                speedX: Math.random() * 0.5 - 0.25,
                speedY: Math.random() * 0.5 - 0.25
            }));

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => {
                    ctx.fillStyle = 'rgba(147, 51, 234, 0.3)';
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.fill();
                    p.x += p.speedX;
                    p.y += p.speedY;
                    if (p.x < 0 || p.x > canvas.width) p.speedX *= -1;
                    if (p.y < 0 || p.y > canvas.height) p.speedY *= -1;
                });
                requestAnimationFrame(animate);
            }
            animate();
        }
        createParticles();
    </script>
</body>
</html>
